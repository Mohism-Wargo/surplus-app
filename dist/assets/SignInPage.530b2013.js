import{bz as g,bD as B,bw as d,bT as C,bS as E,bE as e,bQ as m}from"./vendor.6a6b1e94.js";import{u as k,B as x,I as F,b as I,F as r,a as N,M as j,v as D,c as M,h as f}from"./index.79152699.js";import"./vant.6410adee.js";const q=c=>{const t=g(c);return{ref:t,toggle:()=>t.value=!t.value,on:()=>t.value=!0,off:()=>t.value=!1}},L="_logo_hanpo_1",O="_icon_hanpo_8",R="_appName_hanpo_12",U="_EmailTip_hanpo_18",z="_validateTip_hanpo_19",l={logo:L,icon:O,appName:R,EmailTip:U,validateTip:z},H=B({setup:(c,t)=>{const b=k(),o=d({email:"SurplusApp@snapmail.cc",code:"123456"}),s=d({email:[],code:[]}),u=g(),{ref:_,toggle:A,on:v,off:h}=q(!1),y=C(),T=E(),S=async a=>{var n;if(a.preventDefault(),Object.assign(s,{email:[],code:[]}),Object.assign(s,D(o,[{key:"email",type:"required",message:"\u5FC5\u586B"},{key:"email",type:"pattern",regex:/.+@.+/,message:"\u5FC5\u987B\u662F\u90AE\u7BB1\u5730\u5740"},{key:"code",type:"required",message:"\u5FC5\u586B"}])),!M(s)){const i=await f.post("/session",o,{_autoLoading:!0}).catch(p);localStorage.setItem("jwt",i.data.jwt);const V=(n=T.query.return_to)==null?void 0:n.toString();b.refreshMe(),y.push(V||"/")}},p=a=>{throw a.response.status===422&&Object.assign(s,a.response.data.errors),a},w=async()=>{v(),await f.post("/validation_codes",{email:o.email},{_autoLoading:!0}).catch(p).finally(h),u.value.startCount()};return()=>e(j,null,{title:()=>"\u767B\u5F55",icon:()=>e(x,null,null),default:()=>e("div",{class:l.wrapper},[e("div",{class:l.logo},[e(F,{class:l.icon,name:"whale"},null),e("h1",{class:l.appName},[m("\u6709\u4F59\u8BB0\u8D26")])]),e(I,{onSubmit:S},{default:()=>{var a,n;return[e(r,{label:"\u90AE\u7BB1\u5730\u5740\uFF1A",type:"text",class:l.EmailTip,placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\uFF0C\u7136\u540E\u70B9\u51FB\u83B7\u53D6\u9A8C\u8BC1\u7801",modelValue:o.email,"onUpdate:modelValue":i=>o.email=i,error:(a=s.email)==null?void 0:a[0]},null),e(r,{ref:u,label:"\u9A8C\u8BC1\u7801\uFF1A",type:"validationCode",class:l.validateTip,placeholder:"\u8F93\u5165\u516D\u4F4D\u9A8C\u8BC1\u7801",countFrom:2,disabled:_.value,onClick:w,modelValue:o.code,"onUpdate:modelValue":i=>o.code=i,error:(n=s.code)==null?void 0:n[0]},null),e(r,{style:{paddingTop:"96px"}},{default:()=>[e(N,{type:"submit"},{default:()=>[m("\u767B\u5F55")]})]})]}})])})}});export{H as SignInPage,H as default};
